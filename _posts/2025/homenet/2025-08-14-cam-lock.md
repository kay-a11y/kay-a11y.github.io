---
layout: post
title: "Fixing the `user is locked` Error in Hikvision & Correct RTSP Path Setup"
description: 
date: 2025-08-13 09:36:00 +0000
categories: [ü§ñ tech, üè† homenet]
tags: [üêß Linux, üîÄ LAN, üì∑ Iot]
img_path: /assets/img/posts/
math: true
toc: true 
comments: true 
image: 
---

## Background

I was trying to set the `Custom 1` protocol source path so I could play the camera video on my PC. By mistake, I changed the protocol from `Hikvision` to `Custom 1` for the D1, D2, and D3 cameras. After switching their protocol back to `Hikvision`, the status showed **"Offline (user is locked)"**. All other settings remained unchanged.

## Quick fix

This is a classic Hikvision account lock, nothing to do with "custom protocol broke it" thing. Switching to the wrong protocol caused the NVR to repeatedly attempt invalid logins, which triggered the camera's lockout mechanism.

To fix:

1. **Stop the hammering**: on the NVR go to *Channel/IP Camera* and **disable or delete D1-D3** (or unplug their PoE for a minute).
2. **Clear the lock**: wait \~30 minutes **or just power-cycle each camera** (PoE off/on).
3. **Re-add with Hikvision protocol**: set **Protocol = HIKVISION**, **Mgmt port = 8000**, correct **admin/password**, **Or** just use the `quick add`, then *Add/Modify* ‚Üí status should flip to **online**.
4. **Test RTSP from your PC** with the right path (below). If that plays, the NVR will too.

## RTSP Playback on Linux (Totem, mpv, ffplay)

* Hikvision RTSP (main stream ch1):

   ```bash
   rtsp://admin:<password>@<cam_ip>:554/Streaming/Channels/101
   ```

* Substream: replace `101` ‚Üí `102`.

* If Totem is picky, try:

   ```bash
   mpv rtsp://admin:<password>@<cam_ip>:554/Streaming/Channels/101
   # or, very robust:
   ffplay -rtsp_transport tcp rtsp://admin:<password>@<cam_ip>:554/Streaming/Channels/101
   ```

## If "User is Locked" Persists

* Confirm no other client is still hitting the cam with the **old password**.
* Power-cycle again, then try adding it **manually** with the settings above.
* Worst-case: factory reset.

<div style="display: flex; justify-content: center; align-items: center; margin: 1em 0;">
  <div style="position: relative; display: inline-block; width: 150px; height: auto;">
    <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png"
         alt="Support me on Ko-fi"
         width="150"
         loading="lazy"
         style="display: block; width: 80%; height: auto;">
    <div onclick="window.open('https://ko-fi.com/kikisec', '_blank')"
         style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: transparent; cursor: pointer;">
    </div>
  </div>
</div>
